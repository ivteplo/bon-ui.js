<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Bon UI test</title>
	</head>
	<body>
        <div id="root"></div>
		<script src="../../Distribution/BonUI.umd.js"></script>
		<script>
			const { View, Text, ApplicationManager, Colors } = BonUI

            class AppView extends View {
                initialState() {
                    return { text: "Hello world" }
                }

                body(side) {
                    if (side === "client") {
                        return (
                            new Text(this.state.get("text"))
                                .foreground({ color: Colors.vividOrangePeel })
                                .handle("click", () => {
                                    this.state.set({ text: "Hi!" })
                                })
                        )
                    }

                    return (
                        new Text("Loading...")
                            .foreground({ color: Colors.gray })
                            .setAttributes({ "class": "my-text" })
                    )
                }
            }

            class AppManager extends ApplicationManager {
                initialize() {
                    this.setView(new AppView({ pathname: location.pathname }))
                        .setTitle("Bon UI - Hello World!")
                        .setThemeColor(Colors.vividOrangePeel)
                }

                loadApp() {
                    AppManager.normalizeDocumentStyles({ flexBody: true })
                    const rootNode = document.querySelector("#root")
                    rootNode.innerHTML = this.getViewString()
                    const ssrNode = rootNode.children[0]
                    setTimeout(() => {
                        super.loadApp({ ssrNode })
                    }, 1000)
                }
            }

            const appManager = new AppManager()
            window.addEventListener("load", () => {
                appManager.loadApp()
            })
		</script>
	</body>
</html>
